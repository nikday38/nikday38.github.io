<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copyright Control</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #2c3e50;
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            color: #7f8c8d;
            margin: 10px 0 0 0;
        }
        .upload-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        @media (max-width: 768px) {
            .upload-section {
                grid-template-columns: 1fr;
            }
        }
        .upload-box {
            border: 3px dashed #3498db;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .upload-box:hover {
            background: #e8f4fc;
            border-color: #2980b9;
            transform: translateY(-2px);
        }
        .upload-box p {
            margin: 0;
            font-size: 16px;
            color: #3498db;
            font-weight: 500;
        }
        .upload-box i {
            font-size: 48px;
            color: #3498db;
            margin-bottom: 15px;
        }
        .preview-container {
            margin-top: 15px;
            text-align: center;
        }
        .preview-container img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .preview-container p {
            margin: 8px 0 0 0;
            font-size: 14px;
            color: #7f8c8d;
        }
        .button {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 18px 35px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            display: block;
            margin: 30px auto;
            width: 250px;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }
        .button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(52, 152, 219, 0.4);
        }
        .button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .loading {
            text-align: center;
            padding: 30px;
            display: none;
        }
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .result-container {
            margin-top: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            display: none;
        }
        .result-header {
            text-align: center;
            margin-bottom: 25px;
        }
        .similarity-score {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
        .high-similarity {
            color: #e74c3c;
        }
        .medium-similarity {
            color: #f39c12;
        }
        .low-similarity {
            color: #27ae60;
        }
        .verdict {
            text-align: center;
            font-size: 1.5em;
            font-weight: 600;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            background: white;
        }
        .difference-canvas {
            max-width: 100%;
            margin: 20px auto;
            display: block;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            display: none;
        }
        .file-input {
            display: none;
        }
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-size: 14px;
        }
        .instructions h3 {
            margin: 0 0 10px 0;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Copyright Control</h1>
            <p>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–ª–∞–≥–∏–∞—Ç–∞</p>
        </div>

        <div class="instructions">
            <h3>üìã –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
            <p>1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</p>
            <p>2. –ù–∞–∂–º–∏—Ç–µ "–°—Ä–∞–≤–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"</p>
            <p>3. –î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞</p>
            <p>üí° –°–æ–≤–µ—Ç: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</p>
        </div>

        <div class="upload-section">
            <div class="upload-box" onclick="document.getElementById('file-input1').click()">
                <div>üìÅ</div>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</p>
                <div class="preview-container" id="preview1"></div>
            </div>

            <div class="upload-box" onclick="document.getElementById('file-input2').click()">
                <div>üìÅ</div>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ç–æ—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</p>
                <div class="preview-container" id="preview2"></div>
            </div>
        </div>

        <input type="file" id="file-input1" class="file-input" accept="image/*" onchange="handleFileSelect(this, 'preview1')">
        <input type="file" id="file-input2" class="file-input" accept="image/*" onchange="handleFileSelect(this, 'preview2')">

        <div class="error" id="error-message"></div>

        <button class="button" id="compare-btn" onclick="compareImages()" disabled>–°—Ä–∞–≤–Ω–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è... –≠—Ç–æ –∑–∞–π–º—ë—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥</p>
        </div>

        <div class="result-container" id="result">
            <div class="result-header">
                <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</h2>
            </div>
            
            <div id="similarity-container">
                <div class="similarity-score" id="similarity-score">0%</div>
                <div class="verdict" id="verdict"></div>
            </div>

            <canvas id="difference-canvas" class="difference-canvas"></canvas>
            
            <div id="result-details"></div>
        </div>
    </div>

    <script>
        let image1 = null;
        let image2 = null;

        function handleFileSelect(input, previewId) {
            const file = input.files[0];
            if (!file || !file.type.match('image.*')) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPEG, PNG, GIF)');
                return;
            }

            hideError();
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById(previewId);
                const img = document.createElement('img');
                img.src = e.target.result;
                img.style.maxWidth = '100%';
                img.style.maxHeight = '150px';
                
                preview.innerHTML = '';
                preview.appendChild(img);
                preview.innerHTML += `<p>${file.name}<br>${Math.round(file.size/1024)} KB</p>`;
                
                if (previewId === 'preview1') {
                    image1 = img;
                } else {
                    image2 = img;
                }
                
                checkButtonState();
            };
            reader.readAsDataURL(file);
        }

        function checkButtonState() {
            const btn = document.getElementById('compare-btn');
            btn.disabled = !(image1 && image2);
        }

        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function hideError() {
            const errorDiv = document.getElementById('error-message');
            errorDiv.style.display = 'none';
        }

        function compareImages() {
            if (!image1 || !image2) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            document.getElementById('loading').style.display = 'block';
            document.getElementById('compare-btn').disabled = true;
            document.getElementById('result').style.display = 'none';
            hideError();

            // –î–∞–µ–º –±—Ä–∞—É–∑–µ—Ä—É –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏
            setTimeout(() => {
                try {
                    // –°–æ–∑–¥–∞–µ–º canvas –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
                    const canvas1 = document.createElement('canvas');
                    const canvas2 = document.createElement('canvas');
                    const ctx1 = canvas1.getContext('2d');
                    const ctx2 = canvas2.getContext('2d');

                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã
                    const width = Math.min(image1.naturalWidth, image2.naturalWidth, 800);
                    const height = Math.min(image1.naturalHeight, image2.naturalHeight, 600);

                    canvas1.width = canvas2.width = width;
                    canvas1.height = canvas2.height = height;

                    // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ canvas
                    ctx1.drawImage(image1, 0, 0, width, height);
                    ctx2.drawImage(image2, 0, 0, width, height);

                    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–∏–∫—Å–µ–ª–µ–π
                    const imageData1 = ctx1.getImageData(0, 0, width, height);
                    const imageData2 = ctx2.getImageData(0, 0, width, height);
                    const data1 = imageData1.data;
                    const data2 = imageData2.data;

                    let differentPixels = 0;
                    const totalPixels = width * height;

                    // –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–∏—è–º–∏
                    const diffCanvas = document.createElement('canvas');
                    diffCanvas.width = width;
                    diffCanvas.height = height;
                    const diffCtx = diffCanvas.getContext('2d');
                    diffCtx.drawImage(image1, 0, 0, width, height);

                    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å
                    for (let i = 0; i < data1.length; i += 4) {
                        const r1 = data1[i];
                        const g1 = data1[i + 1];
                        const b1 = data1[i + 2];
                        
                        const r2 = data2[i];
                        const g2 = data2[i + 1];
                        const b2 = data2[i + 2];

                        // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø–∏–∫—Å–µ–ª—è–º–∏
                        const diff = Math.abs(r1 - r2) + Math.abs(g1 - g2) + Math.abs(b1 - b2);
                        
                        if (diff > 100) { // –ü–æ—Ä–æ–≥ —Ä–∞–∑–ª–∏—á–∏—è
                            differentPixels++;
                            // –ü–æ–º–µ—á–∞–µ–º —Ä–∞–∑–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ –∫—Ä–∞—Å–Ω—ã–º
                            diffCtx.fillStyle = 'rgba(255, 0, 0, 0.5)';
                            const x = (i / 4) % width;
                            const y = Math.floor((i / 4) / width);
                            diffCtx.fillRect(x, y, 2, 2);
                        }
                    }

                    // –í—ã—á–∏—Å–ª—è–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
                    const similarity = ((totalPixels - differentPixels) / totalPixels) * 100;
                    const similarityRounded = Math.round(similarity * 100) / 100;

                    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    displayResult(similarityRounded, diffCanvas);

                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞:', error);
                    showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ' + error.message);
                } finally {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('compare-btn').disabled = false;
                }
            }, 100);
        }

        function displayResult(similarity, diffCanvas) {
            const resultDiv = document.getElementById('result');
            const similarityScore = document.getElementById('similarity-score');
            const verdict = document.getElementById('verdict');
            const differenceCanvas = document.getElementById('difference-canvas');
            const resultDetails = document.getElementById('result-details');

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ö–æ–∂–µ—Å—Ç—å
            similarityScore.textContent = similarity + '%';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–µ—Ä–¥–∏–∫—Ç
            let verdictText = '';
            let verdictClass = '';
            
            if (similarity >= 85) {
                verdictText = 'üö® –í–´–°–û–ö–ê–Ø –í–ï–†–û–Ø–¢–ù–û–°–¢–¨ –ü–õ–ê–ì–ò–ê–¢–ê!';
                verdictClass = 'high-similarity';
            } else if (similarity >= 70) {
                verdictText = '‚ö†Ô∏è –ó–ù–ê–ß–ò–¢–ï–õ–¨–ù–´–ï –°–û–í–ü–ê–î–ï–ù–ò–Ø';
                verdictClass = 'medium-similarity';
            } else if (similarity >= 50) {
                verdictText = 'üîç –£–ú–ï–†–ï–ù–ù–û–ï –°–•–û–î–°–¢–í–û';
                verdictClass = 'medium-similarity';
            } else {
                verdictText = '‚úÖ –ó–ù–ê–ß–ò–¢–ï–õ–¨–ù–´–ï –†–ê–ó–õ–ò–ß–ò–Ø';
                verdictClass = 'low-similarity';
            }

            similarityScore.className = 'similarity-score ' + verdictClass;
            verdict.textContent = verdictText;
            verdict.className = 'verdict ' + verdictClass;

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞—Ä—Ç—É —Ä–∞–∑–ª–∏—á–∏–π
            const ctx = differenceCanvas.getContext('2d');
            differenceCanvas.width = diffCanvas.width;
            differenceCanvas.height = diffCanvas.height;
            ctx.drawImage(diffCanvas, 0, 0);

            // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏
            resultDetails.innerHTML = `
                <div style="text-align: center; margin-top: 20px;">
                    <p><strong>–î–µ—Ç–∞–ª–∏ –∞–Ω–∞–ª–∏–∑–∞:</strong></p>
                    <p>‚Ä¢ –ö—Ä–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–∏–π</p>
                    <p>‚Ä¢ –ü–æ—Ä–æ–≥ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: 100 –µ–¥–∏–Ω–∏—Ü —Ü–≤–µ—Ç–∞</p>
                    <p>‚Ä¢ –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π</p>
                </div>
            `;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
